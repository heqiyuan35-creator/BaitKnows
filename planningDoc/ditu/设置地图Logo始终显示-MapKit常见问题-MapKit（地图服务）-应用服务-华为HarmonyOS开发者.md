<h1 _ngcontent-ski-c119="" class="doc-title ng-star-inserted" title="设置地图Logo始终显示"> 设置地图Logo始终显示 </h1>

<div _ngcontent-ski-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p><strong>现象描述</strong></p> <p>Map Kit地图Logo不可见。</p> <p><span><img height="431.074546" originheight="543" originwidth="387" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114624.42039389586789662426542710044296:50001231000000:2800:82B7019C48FB20B8EE3EDC8AFC30D478D25A3DEC06ACADF9D82C8686AAF7407D.png" title="点击放大" width="307.23"></span></p> <p><strong>可能原因</strong></p> <p>用户在开发过程中，地图Logo被其他控件或者页面遮挡。</p> <p><strong>处理步骤</strong></p> <p>Map Kit无法隐藏地图Logo，也不允许地图Logo被遮挡。用户可以实现地图Logo自动避让，保证地图Logo持续展示，解决方案参考如下代码：</p> <div _ngcontent-ski-c106="" class="highlight-div"><div _ngcontent-ski-c106="" class="highlight-div-header"><div _ngcontent-ski-c106="" class="highlight-div-header-left"><div _ngcontent-ski-c106="" class="handle-button expand-button"><div _ngcontent-ski-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ski-c106="" class="highlight-div-header-right"><div _ngcontent-ski-c106="" class="handle-button ai-button"></div><div _ngcontent-ski-c106="" class="handle-button line-button"><div _ngcontent-ski-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ski-c106="" class="handle-button theme-button"><div _ngcontent-ski-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ski-c106="" class="handle-button copy-button"><div _ngcontent-ski-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ski-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">MapComponent</span>, mapCommon, map } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MapKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MapKitAppDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOptions?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>  <span class="hljs-keyword">private</span> mapController?: map.<span class="hljs-property">MapComponentController</span>;</li><li>  <span class="hljs-keyword">private</span> mapEventManager?: map.<span class="hljs-property">MapEventManager</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">'MapKitAppDemo'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isShowSheet</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title class_">Panel</span>() {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>() {</li><li>          <span class="hljs-title class_">SymbolSpan</span>($r(<span class="hljs-string">'sys.symbol.magnifyingglass'</span>))</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)</li><li>            .<span class="hljs-title function_">fontColor</span>([<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>])</li><li>        }</li><li>
</li><li>        <span class="hljs-title class_">TextInput</span>()</li><li>          .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#33b1afaf'</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">8</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>    .<span class="hljs-title function_">padding</span>({</li><li>      <span class="hljs-attr">top</span>: <span class="hljs-number">8</span>,</li><li>      <span class="hljs-attr">left</span>: <span class="hljs-number">8</span>,</li><li>      <span class="hljs-attr">right</span>: <span class="hljs-number">8</span>,</li><li>      <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span></li><li>    })</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 地图初始化参数，设置地图中心点坐标及层级</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.979227</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.762245</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">17</span></li><li>      }</li><li>    };</li><li>
</li><li>    <span class="hljs-comment">// 地图初始化的回调</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-comment">// 获取地图的控制器类，用来操作地图</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span> = mapController;</li><li>        <span class="hljs-comment">// 返回地图组件的监听事件管理接口</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">getEventManager</span>();</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">TAG</span>, <span class="hljs-string">`on-mapLoad`</span>);</li><li>        }</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>?.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mapLoad'</span>, callback);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to initialize the map, code is：<span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>?.<span class="hljs-title function_">off</span>(<span class="hljs-string">'mapLoad'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">clear</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">bindSheetOptions</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> bindSheetOptions = {</li><li>      <span class="hljs-comment">// 半模态框三个状态的高度</span></li><li>      <span class="hljs-attr">detents</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">300</span>, <span class="hljs-number">500</span>],</li><li>      <span class="hljs-comment">// 半模态所在页面允许交互</span></li><li>      <span class="hljs-attr">enableOutsideInteractive</span>: <span class="hljs-literal">true</span>,</li><li>      <span class="hljs-attr">maskColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Transparent</span>,</li><li>      <span class="hljs-attr">backgroundColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>,</li><li>      <span class="hljs-attr">blurStyle</span>: <span class="hljs-title class_">BlurStyle</span>.<span class="hljs-property">Thick</span>,</li><li>      <span class="hljs-attr">showClose</span>: <span class="hljs-literal">false</span>,</li><li>      <span class="hljs-attr">preferType</span>: <span class="hljs-title class_">SheetType</span>.<span class="hljs-property">CENTER</span>,</li><li>      <span class="hljs-attr">onAppear</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">setPadding</span>({</li><li>          <span class="hljs-attr">bottom</span>: <span class="hljs-number">358</span></li><li>        })</li><li>      },</li><li>      <span class="hljs-attr">onHeightDidChange</span>: <span class="hljs-function">(<span class="hljs-params">height: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 动态设置地图底部边距，避免遮挡logo</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">setPadding</span>({</li><li>          <span class="hljs-attr">bottom</span>: height + <span class="hljs-number">8</span></li><li>        })</li><li>      }</li><li>    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">BindOptions</span></li><li>    <span class="hljs-keyword">return</span> bindSheetOptions;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-comment">// 调用MapComponent组件初始化地图</span></li><li>        <span class="hljs-title class_">MapComponent</span>({ <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span>, <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>        <span class="hljs-title class_">Column</span>()</li><li>          .<span class="hljs-title function_">bindSheet</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isShowSheet</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">Panel</span>(), <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindSheetOptions</span>())</li><li>          .<span class="hljs-title function_">visibility</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isShowSheet</span> ? <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">None</span>)</li><li>          .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> <p>展示效果如图所示：</p> <p><span><img height="683.178706" originheight="1836" originwidth="874" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114624.04662947982705129817823013293588:50001231000000:2800:C7F6D7CED78210A380ED17FDA588D658E4B77A61E79223F8CCBC5101ACBB69A4.gif" title="点击放大" width="325.185931"></span></p> </div> <div></div></div>
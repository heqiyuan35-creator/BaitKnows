<h1 _ngcontent-ngu-c119="" class="doc-title ng-star-inserted" title="标记"> 标记 </h1>

<div _ngcontent-ngu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2>          <p>从5.1.1(19)开始，支持控制Marker文字显隐功能；从6.0.0(20)开始，支持自定义组件实现marker图标功能。</p>     <p>本章节将向您介绍如何<span style="color: rgb(38,38,38);">在地图的指定位置添加标记以标识位置、商家、建</span><span style="color: rgb(38,38,38);">筑等</span><span style="color: rgb(38,38,38);">。</span></p>     <p class="typescript">点标记用来在地图上标记任何位置，例如用户位置、车辆位置、店铺位置等一切带有位置属性的事物。Map Kit提供的点标记功能（又称 Marker）封装了大量的触发事件，例如点击事件、长按事件、拖拽事件。</p>     <p>Marker有默认风格，同时也支持自定义。由于内容丰富，以下只能展示一些基础功能的使用。</p>     <p><span><img height="435.585241" originheight="396" originwidth="331" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.22364802105537095444991221689174:50001231000000:2800:1635BC0FE4E729FE021CEE0345F1BA41447992F29FB5182DCECD4DE67CBB223C.png" title="点击放大" width="364.08750000000003"></span></p>    </div>    <div class="tiledSection">     <h2 id="section1014125014720">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1014125014720" tips="复制节点链接"></i></h2>          <p><span style="color: rgb(38,38,38);">添加标记</span>功能主要由<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-common#section559041743210" target="_blank">MarkerOptions</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section0810361284" target="_blank">addMarker</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">Marker</a>提供，更多接口及使用方法请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="64.03%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="35.97%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="64.03%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-common#section559041743210" target="_blank">MarkerOptions</a></p></td>         <td class="cellrowborder" valign="top" width="35.97%">          <p>标记参数。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="64.03%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section0810361284" target="_blank">addMarker</a>(options: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-common#section559041743210" target="_blank">mapCommon.MarkerOptions</a>): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">Marker</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="35.97%">          <p>在地图上添加标记。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="64.03%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">Marker</a></p></td>         <td class="cellrowborder" valign="top" width="35.97%">          <p>标记，支持更新和查询相关属性。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1564972414506">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1564972414506" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section2594451570" class="firsth2">添加标记<i class="anchor-icon anchor-icon-link" anchorid="section2594451570" tips="复制节点链接"></i></h3>          <ol>      <li>导入相关模块。       <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">MapComponent</span>, mapCommon, map } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MapKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div></li>      <li>添加标记，在callback方法中创建初始化参数并新建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">Marker</a>。       <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MarkerDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOptions?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> mapController?: map.<span class="hljs-property">MapComponentController</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>  <span class="hljs-keyword">private</span> mapEventManager?: map.<span class="hljs-property">MapEventManager</span>;</li><li>  <span class="hljs-keyword">private</span> marker?: map.<span class="hljs-property">Marker</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 地图初始化参数</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">15</span></li><li>      }</li><li>    };</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span> = mapController;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">getEventManager</span>();</li><li>        <span class="hljs-comment">// Marker初始化参数</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>          <span class="hljs-attr">position</span>: {</li><li>            <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>            <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>          },</li><li>          <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,</li><li>          <span class="hljs-attr">visible</span>: <span class="hljs-literal">true</span>,</li><li>          <span class="hljs-attr">zIndex</span>: <span class="hljs-number">0</span>,</li><li>          <span class="hljs-attr">alpha</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">anchorU</span>: <span class="hljs-number">0.5</span>,</li><li>          <span class="hljs-attr">anchorV</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">clickable</span>: <span class="hljs-literal">true</span>,</li><li>          <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,</li><li>          <span class="hljs-attr">flat</span>: <span class="hljs-literal">false</span></li><li>        };</li><li>        <span class="hljs-comment">// 创建Marker</span></li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li>        } <span class="hljs-keyword">catch</span> (e) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to create the marker, code is：<span class="hljs-subst">${e.code}</span>, message is <span class="hljs-subst">${e.message}</span>`</span>);</li><li>        }</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to initialize the map, code is：<span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">MapComponent</span>({ <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span>, <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> });</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img height="647.64084" originheight="783" originwidth="363" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.32011306161879524961677087850956:50001231000000:2800:6BE06C95A68DA9C34A7E3D4795E40125B1879E73FBDBF98FDA67B881B5094C91.png" title="点击放大" width="300.2475"></span></p></li>      <li><span style="color: rgb(38,38,38);">在添加标记之后，修改已经设置的标记属性。</span>       <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 设置标记可拖拽</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setDraggable</span>(<span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 设置标记锚点</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setMarkerAnchor</span>(<span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section877912473582">自定义标记<i class="anchor-icon anchor-icon-link" anchorid="section877912473582" tips="复制节点链接"></i></h3>          <div class="p">      通过在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-common#section559041743210" target="_blank">MarkerOptions</a>中将icon属性设置为自定义图标的资源，可将默认标记图标修改成自定义图标。      <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>  <span class="hljs-attr">position</span>: {</li><li>    <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>    <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>  },</li><li>  <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">visible</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">alpha</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">anchorU</span>: <span class="hljs-number">0.5</span>,</li><li>  <span class="hljs-attr">anchorV</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">clickable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">flat</span>: <span class="hljs-literal">false</span>,</li><li>  <span class="hljs-comment">// 图标存放在resources/rawfile，icon参数传入rawfile文件夹下的相对路径</span></li><li>  <span class="hljs-attr">icon</span>: <span class="hljs-string">'test.png'</span></li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">addMarker</span>(markerOptions);</li></ol></pre></div></div>     </div>     <p><span><img height="460.28440500000005" originheight="507" originwidth="420" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.38534999728557389808703082897028:50001231000000:2800:ADB003673E5973796E0CC1B2BFCE4454405CA2C1F06E7123F7543A3FEE4265DE.png" title="点击放大" width="381.30036"></span></p>    </div>    <div class="tiledSection">     <h3 id="section6138183716918">控制Marker文字显隐<i class="anchor-icon anchor-icon-link" anchorid="section6138183716918" tips="复制节点链接"></i></h3>          <div class="p">      通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker#section6403556152318" target="_blank">setAnnotationVisible</a>方法可以控制Marker文字显隐，还可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker#section7880311173111" target="_blank">isAnnotationVisible</a>方法来获取Marker文字显隐的状态。      <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Marker初始化参数</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>  <span class="hljs-attr">position</span>: {</li><li>    <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>    <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>  },</li><li>  <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">visible</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">alpha</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">anchorU</span>: <span class="hljs-number">0.5</span>,</li><li>  <span class="hljs-attr">anchorV</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">clickable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">flat</span>: <span class="hljs-literal">false</span>,</li><li>  <span class="hljs-attr">annotations</span>: [{</li><li>    <span class="hljs-comment">// 定义标题内容</span></li><li>    <span class="hljs-attr">content</span>: <span class="hljs-string">"text"</span>,</li><li>    <span class="hljs-attr">fontStyle</span>: <span class="hljs-number">1</span>,</li><li>    <span class="hljs-attr">strokeWidth</span>: <span class="hljs-number">3</span>,</li><li>    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">15</span></li><li>  }]</li><li>};</li><li><span class="hljs-comment">// 创建Marker</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li><span class="hljs-comment">// 设置文字隐藏</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setAnnotationVisible</span>(<span class="hljs-literal">false</span>);</li><li><span class="hljs-comment">// 查询当前显隐状态</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">isAnnotationVisible</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">isAnnotationVisible</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`isAnnotationVisible is: `</span> + isAnnotationVisible);</li></ol></pre></div></div>     </div>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td class="nocellnorowborder" style="border: none;" valign="top" width="50%">          <div class="fignone">           <span class="figcap"><b>图1 </b>隐藏Marker文字之前</span>          </div></td>         <td class="cell-norowborder" style="border: none;" valign="top" width="50%">          <div class="fignone">           <span class="figcap"><b>图2 </b>隐藏Marker文字之后</span>          </div></td>        </tr>        <tr>         <td class="row-nocellborder" style="border: none;" valign="top" width="50%">          <p><span><img originheight="692" originwidth="390" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.31525028802106397854976366303019:50001231000000:2800:780C1B548B72C4C16E8DF9B109149CC1B1D0EA7CAF1E9A501F0FF36DF000865A.png" width="390" height="692"></span></p></td>         <td class="cellrowborder" style="border: none;" valign="top" width="50%">          <p><span><img originheight="695" originwidth="392" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.15556339494871694076623126826842:50001231000000:2800:5BF74976E64DF166F240CF104A97756E76B6603C47F9BF8E194EF22C7568EFB6.png" width="392" height="695"></span></p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section18918172513321">碰撞检测<i class="anchor-icon anchor-icon-link" anchorid="section18918172513321" tips="复制节点链接"></i></h3>          <div class="p">      通过在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-common#section559041743210" target="_blank">MarkerOptions</a>中设置collisionRule属性，可以设置标记的冲突处理规则。      <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>  <span class="hljs-attr">position</span>: {</li><li>    <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>    <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>  },</li><li>  <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">visible</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">alpha</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">anchorU</span>: <span class="hljs-number">0.5</span>,</li><li>  <span class="hljs-attr">anchorV</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">clickable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">flat</span>: <span class="hljs-literal">false</span>,</li><li>  <span class="hljs-comment">// 图标存放在resources/rawfile，icon参数传入rawfile文件夹下的相对路径</span></li><li>  <span class="hljs-attr">icon</span>: <span class="hljs-string">'icon.png'</span>,</li><li>  <span class="hljs-attr">annotations</span>:  [{</li><li>    <span class="hljs-comment">// 定义标题内容</span></li><li>    <span class="hljs-attr">content</span>: <span class="hljs-string">"Test"</span>,</li><li>    <span class="hljs-attr">fontStyle</span>: <span class="hljs-number">1</span>,</li><li>    <span class="hljs-attr">strokeWidth</span>: <span class="hljs-number">3</span>,</li><li>    <span class="hljs-attr">fontSize</span>: <span class="hljs-number">15</span></li><li>  }],</li><li>  <span class="hljs-comment">// 设置碰撞规则为图标和名称都参与碰撞</span></li><li>  <span class="hljs-attr">collisionRule</span>: mapCommon.<span class="hljs-property">CollisionRule</span>.<span class="hljs-property">ALL</span>,</li><li>  <span class="hljs-attr">annotationPosition</span>: mapCommon.<span class="hljs-property">TextPosition</span>.<span class="hljs-property">TOP</span></li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>.<span class="hljs-title function_">addMarker</span>(markerOptions);</li></ol></pre></div></div>     </div>     <p><span><img height="649.17699" originheight="1214" originwidth="582" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.49931181020734950976575650706250:50001231000000:2800:01444880FFC115AC51A507D92859EF84317219112D5362145D92BD644CB1730C.gif" title="点击放大" width="311.22"></span></p>    </div>    <div class="tiledSection">     <h3 id="section7182124719591">设置监听标记点击事件<i class="anchor-icon anchor-icon-link" anchorid="section7182124719591" tips="复制节点链接"></i></h3>          <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">marker: map.Marker</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`on-markerClick marker = <span class="hljs-subst">${marker.getId()}</span>`</span>);</li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"markerClick"</span>, callback);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section17838151973412">设置监听标记拖动事件<i class="anchor-icon anchor-icon-link" anchorid="section17838151973412" tips="复制节点链接"></i></h3>          <p>通过如下步骤设置监听标记拖动事件：</p>     <ol>      <li>将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-marker" target="_blank">Marker</a>的拖拽属性设置为true。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section88711444165714" target="_blank">on(type: 'markerDragStart' , callback: Callback&lt;Marker&gt;)</a>方法监听标记是否开始拖拽。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section486516467570" target="_blank">on(type: 'markerDrag' , callback: Callback&lt;Marker&gt;)</a>，监听标记拖动过程。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section288194865719" target="_blank">on(type: 'markerDragEnd' , callback: Callback&lt;Marker&gt;)</a>，监听标记拖动结束事件。</li>     </ol>     <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 设置标记可拖拽</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setDraggable</span>(<span class="hljs-literal">true</span>);</li><li>
</li><li><span class="hljs-comment">// 监听标记开始拖拽</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">markerCallback</span> = (<span class="hljs-params">marker: map.Marker</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`on-markerDragStart marker = <span class="hljs-subst">${marker.getId()}</span>`</span>);</li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"markerDragStart"</span>, markerCallback);</li><li>
</li><li><span class="hljs-comment">// 监听标记拖拽事件</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">markerDragCallback</span> = (<span class="hljs-params">marker: map.Marker</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`on-markerDrag marker = <span class="hljs-subst">${marker.getId()}</span>`</span>);</li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"markerDrag"</span>, markerDragCallback);</li><li>
</li><li><span class="hljs-comment">// 监听标记拖拽结束</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">markerDragEndCallback</span> = (<span class="hljs-params">marker: map.Marker</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`on-markerDragEnd marker = <span class="hljs-subst">${marker.getId()}</span>`</span>);</li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">mapEventManager</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"markerDragEnd"</span>, markerDragEndCallback);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section10384101310422">信息窗<i class="anchor-icon anchor-icon-link" anchorid="section10384101310422" tips="复制节点链接"></i></h3>          <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 添加信息窗</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>  <span class="hljs-attr">position</span>: {</li><li>    <span class="hljs-attr">latitude</span>: <span class="hljs-number">31.984410259206815</span>,</li><li>    <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.76625379397866</span></li><li>  }</li><li>};</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li><span class="hljs-comment">// 设置信息窗的标题</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setTitle</span>(<span class="hljs-string">'南京'</span>);</li><li><span class="hljs-comment">// 设置信息窗的子标题</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setSnippet</span>(<span class="hljs-string">'华东地区'</span>);</li><li><span class="hljs-comment">// 设置标记可点击</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setClickable</span>(<span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 设置信息窗的锚点位置</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setInfoWindowAnchor</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li><span class="hljs-comment">// 设置信息窗可见，点击标记后可展示信息窗</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span>.<span class="hljs-title function_">setInfoWindowVisible</span>(<span class="hljs-literal">true</span>);</li></ol></pre></div></div>    </div>    <p><span><img height="633.7866290000001" originheight="782" originwidth="368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.28456358724965517446664571047504:50001231000000:2800:D2D20314832EFCE00D96FC0F11A921A59932FB7117B3C6CA7E5A65E80F1439B2.png" title="点击放大" width="298.2525"></span></p>    <p></p>    <div class="tiledSection">     <h3 id="section1930164112317">自定义信息窗<i class="anchor-icon anchor-icon-link" anchorid="section1930164112317" tips="复制节点链接"></i></h3>          <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MarkerDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOptions?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> mapController?: map.<span class="hljs-property">MapComponentController</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.120750</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">15</span></li><li>      }</li><li>    }</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span> = mapController;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>          <span class="hljs-attr">position</span>: {</li><li>            <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.120750</span>,</li><li>            <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>          },</li><li>          <span class="hljs-attr">clickable</span>: <span class="hljs-literal">true</span>,</li><li>          <span class="hljs-comment">// 设置信息窗标题，点击标记后可展示信息窗</span></li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"自定义信息窗"</span></li><li>        };</li><li>        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to initialize the map, code is：<span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">MapComponent</span>({</li><li>          <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span>,</li><li>          <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span>,</li><li>          <span class="hljs-comment">// 自定义信息窗</span></li><li>          <span class="hljs-attr">customInfoWindow</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">customInfoWindow</span></li><li>        })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>);</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>  <span class="hljs-comment">// 自定义信息窗BuilderParam</span></li><li>  <span class="hljs-meta">@BuilderParam</span> <span class="hljs-attr">customInfoWindow</span>: <span class="hljs-function">(<span class="hljs-params">$$: map.MarkerDelegate</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">customInfoWindowBuilder</span>;</li><li>  <span class="hljs-comment">// 自定义信息窗Builder</span></li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">customInfoWindowBuilder</span>(<span class="hljs-params">$$: map.MarkerDelegate</span>) {</li><li>    <span class="hljs-keyword">if</span> ($$.<span class="hljs-property">marker</span>) {</li><li>      <span class="hljs-title class_">Text</span>($$.<span class="hljs-property">marker</span>.<span class="hljs-title function_">getTitle</span>())</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">"50%"</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>)</li><li>        .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)</li><li>        .<span class="hljs-title function_">font</span>({ <span class="hljs-attr">size</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">weight</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">style</span>: <span class="hljs-title class_">FontStyle</span>.<span class="hljs-property">Italic</span> })</li><li>        .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>, <span class="hljs-attr">radius</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">style</span>: <span class="hljs-title class_">BorderStyle</span>.<span class="hljs-property">Dashed</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img height="643.091176" originheight="782" originwidth="369" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.36340095173847815540015908688944:50001231000000:2800:F57AF95A2BFC71DE2A04E6CD3321EA11795D031A82F1CDAA0DB56AAB5A81AA60.png" title="点击放大" width="303.450539"></span></p>     <p></p>    </div>    <div class="tiledSection">     <h3 id="section150619459810">标记动画<i class="anchor-icon anchor-icon-link" anchorid="section150619459810" tips="复制节点链接"></i></h3>          <p style="color: rgb(38,38,38);">Marker支持设置旋转、缩放、平移、透明、图片动画播放和组合动画效果。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.3.1.3.1.1" valign="top" width="43.169999999999995%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.3.1.3.1.2" valign="top" width="56.830000000000005%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-alphaanimation" target="_blank">AlphaAnimation</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>控制透明度的动画类。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-rotateanimation" target="_blank">RotateAnimation</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>控制旋转的动画类。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-scaleanimation" target="_blank">ScaleAnimation</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>控制缩放的动画类。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-translateanimation" target="_blank">TranslateAnimation</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>控制平移的动画类。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-playimageanimation" target="_blank">PlayImageAnimation</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>控制多张图片的动画类。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="43.169999999999995%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-animationset" target="_blank">AnimationSet</a></p></td>         <td class="cellrowborder" valign="top" width="56.830000000000005%">          <p>动画集合。</p></td>        </tr>             </tbody></table></div>     </div>     <p>旋转动画效果的示例代码如下：</p>     <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { map, mapCommon, <span class="hljs-title class_">MapComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MapKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MarkerDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOptions?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.020750</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">11</span></li><li>      }</li><li>    }</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-comment">// 构造MarkerOptions对象</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>          <span class="hljs-attr">position</span>: {</li><li>            <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.020750</span>,</li><li>            <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>          }</li><li>        };</li><li>        <span class="hljs-comment">// 新建marker</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">marker</span>: map.<span class="hljs-property">Marker</span> = <span class="hljs-keyword">await</span> mapController.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li>        <span class="hljs-comment">// 构造RotateAnimation对象</span></li><li>        <span class="hljs-keyword">let</span> animation = <span class="hljs-keyword">new</span> map.<span class="hljs-title class_">RotateAnimation</span>(<span class="hljs-number">0</span>, <span class="hljs-number">270</span>);</li><li>        <span class="hljs-comment">// 动画执行时间</span></li><li>        animation.<span class="hljs-title function_">setDuration</span>(<span class="hljs-number">2000</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画结束状态</span></li><li>        animation.<span class="hljs-title function_">setFillMode</span>(map.<span class="hljs-property">AnimationFillMode</span>.<span class="hljs-property">BACKWARDS</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画重复模式</span></li><li>        animation.<span class="hljs-title function_">setRepeatMode</span>(map.<span class="hljs-property">AnimationRepeatMode</span>.<span class="hljs-property">REVERSE</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画重复次数</span></li><li>        animation.<span class="hljs-title function_">setRepeatCount</span>(<span class="hljs-number">100</span>);</li><li>
</li><li>        <span class="hljs-comment">// 设置动画开始监听</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-title function_">callbackStart</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"animationStart"</span>, <span class="hljs-string">`callback`</span>);</li><li>        };</li><li>        animation.<span class="hljs-title function_">on</span>(<span class="hljs-string">"animationStart"</span>, callbackStart);</li><li>
</li><li>        <span class="hljs-comment">// 设置动画结束监听</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-title function_">callbackEnd</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"animationEnd"</span>, <span class="hljs-string">`callback`</span>);</li><li>        };</li><li>        animation.<span class="hljs-title function_">on</span>(<span class="hljs-string">"animationEnd"</span>, callbackEnd);</li><li>
</li><li>        <span class="hljs-comment">// 设置动画</span></li><li>        marker.<span class="hljs-title function_">setAnimation</span>(animation);</li><li>        <span class="hljs-comment">// 开启动画</span></li><li>        marker.<span class="hljs-title function_">startAnimation</span>();</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to initialize the map, code is：<span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">MapComponent</span>({ <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span>, <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>展示效果如图：</p>     <p><span><img height="762.7224150000001" originheight="884" originwidth="400" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114533.83595966232131478531069714952242:50001231000000:2800:687850E856DB2BA702F12D0D2DE991AFFB9080BA28D348178911F17465704A5A.gif" title="点击放大" width="345.135"></span></p>    </div>    <div class="tiledSection">     <h3 id="section1865823703414">图片动画播放<i class="anchor-icon anchor-icon-link" anchorid="section1865823703414" tips="复制节点链接"></i></h3>          <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { map, mapCommon, <span class="hljs-title class_">MapComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MapKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MarkerDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOptions?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.020750</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">11</span></li><li>      }</li><li>    }</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-comment">// 构造MarkerOptions对象</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>          <span class="hljs-attr">position</span>: {</li><li>            <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.020750</span>,</li><li>            <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>          },</li><li>        };</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">images</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">ResourceStr</span> | image.<span class="hljs-property">PixelMap</span>&gt; = [</li><li>          <span class="hljs-comment">// 图标需存放在resources/rawfile目录下</span></li><li>          <span class="hljs-string">'icon/avocado.png'</span>,</li><li>          <span class="hljs-string">'icon/20231027.png'</span>,</li><li>          <span class="hljs-comment">// 图标需存放在resources/base/media目录下</span></li><li>          $r(<span class="hljs-string">'app.media.maps_blue_dot'</span>)</li><li>        ]</li><li>        <span class="hljs-keyword">let</span> mContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>();</li><li>        <span class="hljs-keyword">if</span> (mContext) {</li><li>          <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> mContext?.<span class="hljs-property">resourceManager</span>?.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'icon/icon.png'</span>);</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">imageSource</span>: image.<span class="hljs-property">ImageSource</span> =</li><li>            image.<span class="hljs-title function_">createImageSource</span>(fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, fileData.<span class="hljs-property">buffer</span>.<span class="hljs-property">byteLength</span>));</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">pixelMap</span>: <span class="hljs-title class_">PixelMap</span> = <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">createPixelMap</span>();</li><li>          images.<span class="hljs-title function_">push</span>(pixelMap);</li><li>        }</li><li>        <span class="hljs-comment">// 新建marker</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">marker</span>: map.<span class="hljs-property">Marker</span> = <span class="hljs-keyword">await</span> mapController.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li>        <span class="hljs-comment">// 构造PlayImageAnimation对象</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">animation</span>: map.<span class="hljs-property">PlayImageAnimation</span> = <span class="hljs-keyword">new</span> map.<span class="hljs-title class_">PlayImageAnimation</span>();</li><li>        <span class="hljs-comment">// 添加图片</span></li><li>        <span class="hljs-keyword">await</span> animation.<span class="hljs-title function_">addImages</span>(images)</li><li>        <span class="hljs-comment">// 动画执行时间</span></li><li>        animation.<span class="hljs-title function_">setDuration</span>(<span class="hljs-number">3000</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画结束状态</span></li><li>        animation.<span class="hljs-title function_">setFillMode</span>(map.<span class="hljs-property">AnimationFillMode</span>.<span class="hljs-property">BACKWARDS</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画重复模式</span></li><li>        animation.<span class="hljs-title function_">setRepeatMode</span>(map.<span class="hljs-property">AnimationRepeatMode</span>.<span class="hljs-property">REVERSE</span>);</li><li>
</li><li>        <span class="hljs-comment">// 动画重复次数</span></li><li>        animation.<span class="hljs-title function_">setRepeatCount</span>(<span class="hljs-number">100</span>);</li><li>
</li><li>        <span class="hljs-comment">// 设置动画开始监听</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-title function_">callbackStart</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"animationStart"</span>, <span class="hljs-string">`callback`</span>);</li><li>        };</li><li>        animation.<span class="hljs-title function_">on</span>(<span class="hljs-string">"animationStart"</span>, callbackStart);</li><li>        <span class="hljs-comment">// 设置动画结束监听</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-title function_">callbackEnd</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"animationEnd"</span>, <span class="hljs-string">`callback`</span>);</li><li>        };</li><li>        animation.<span class="hljs-title function_">on</span>(<span class="hljs-string">"animationEnd"</span>, callbackEnd);</li><li>        <span class="hljs-comment">// 设置动画</span></li><li>        marker.<span class="hljs-title function_">setAnimation</span>(animation);</li><li>        <span class="hljs-comment">// 开启动画</span></li><li>        marker.<span class="hljs-title function_">startAnimation</span>();</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to initialize the map, code is：<span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">MapComponent</span>({ <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOptions</span>, <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>展示效果如图：</p>     <p><span><img height="1060.571925" originheight="2688" originwidth="1216" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114534.01155750787799800360034559696882:50001231000000:2800:CC7061C8014141F364DABB76C5D80D2300259AC8F22B228F3B18F7047164B696.gif" title="点击放大" width="479.7975"></span></p>    </div>    <div class="tiledSection">     <h3 id="section1885775613279">自定义组件实现marker图标<i class="anchor-icon anchor-icon-link" anchorid="section1885775613279" tips="复制节点链接"></i></h3>          <p><span style="color: rgb(38,38,38);">通过自定义组件</span>生成marker图标。</p>     <div _ngcontent-ngu-c106="" class="highlight-div"><div _ngcontent-ngu-c106="" class="highlight-div-header"><div _ngcontent-ngu-c106="" class="highlight-div-header-left"><div _ngcontent-ngu-c106="" class="handle-button expand-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ngu-c106="" class="highlight-div-header-right"><div _ngcontent-ngu-c106="" class="handle-button ai-button"></div><div _ngcontent-ngu-c106="" class="handle-button line-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ngu-c106="" class="handle-button theme-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ngu-c106="" class="handle-button copy-button"><div _ngcontent-ngu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ngu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { map, mapCommon, <span class="hljs-title class_">MapComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MapKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MarkerDemo</span> {</li><li>  <span class="hljs-keyword">private</span> mapOption?: mapCommon.<span class="hljs-property">MapOptions</span>;</li><li>  <span class="hljs-keyword">private</span> mapController?: map.<span class="hljs-property">MapComponentController</span>;</li><li>  <span class="hljs-keyword">private</span> callback?: <span class="hljs-title class_">AsyncCallback</span>&lt;map.<span class="hljs-property">MapComponentController</span>&gt;;</li><li>  <span class="hljs-keyword">private</span> marker?: map.<span class="hljs-property">Marker</span>;</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOption</span> = {</li><li>      <span class="hljs-attr">position</span>: {</li><li>        <span class="hljs-attr">target</span>: {</li><li>          <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.120750</span>,</li><li>          <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>        },</li><li>        <span class="hljs-attr">zoom</span>: <span class="hljs-number">14</span></li><li>      },</li><li>      <span class="hljs-attr">scaleControlsEnabled</span>: <span class="hljs-literal">true</span></li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = <span class="hljs-keyword">async</span> (err, mapController) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span> = mapController;</li><li>        <span class="hljs-comment">// 构造MarkerOptions对象</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">markerOptions</span>: mapCommon.<span class="hljs-property">MarkerOptions</span> = {</li><li>          <span class="hljs-attr">position</span>: {</li><li>            <span class="hljs-attr">latitude</span>: <span class="hljs-number">32.120750</span>,</li><li>            <span class="hljs-attr">longitude</span>: <span class="hljs-number">118.788765</span></li><li>          },</li><li>          <span class="hljs-comment">// 自定义组件</span></li><li>          <span class="hljs-attr">iconBuilder</span>: <span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderBuilder</span>();</li><li>          }</li><li>        };</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">marker</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapController</span>?.<span class="hljs-title function_">addMarker</span>(markerOptions);</li><li>      }</li><li>    }</li><li>  }</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">renderBuilder</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>({ <span class="hljs-attr">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span> }) {</li><li>      <span class="hljs-comment">// 需要替换您自己的资源图片，存放在resources/base/media目录下</span></li><li>      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.iconbuilder'</span>))</li><li>        .<span class="hljs-title function_">syncLoad</span>(<span class="hljs-literal">true</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">MapComponent</span>({ <span class="hljs-attr">mapOptions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mapOption</span>, <span class="hljs-attr">mapCallback</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>);</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>展示效果如图：</p>     <p><span><img height="845.7962100000001" originheight="2832" originwidth="1316" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114534.28872277199210451693807691904029:50001231000000:2800:0AE371610F715736B25C0E70330D190B58FBEB2C31C888EDE268B8F4C50547D1.jpg" title="点击放大" width="393.01500000000004"></span></p>    </div>   </div>   <div></div></div>
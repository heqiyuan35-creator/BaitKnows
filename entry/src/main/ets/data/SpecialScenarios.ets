/**
 * ç‰¹æ®Šåœºæ™¯è§„åˆ™
 * å®šä¹‰å„ç§ç‰¹æ®Šé’“é±¼åœºæ™¯çš„é…æ–¹è°ƒæ•´è§„åˆ?
 */
import { FlavorModifier, StateModifier } from '../common/types/RecipeTypes';

// ç‰¹æ®Šåœºæ™¯ç±»å‹
export type ScenarioType =
  'extreme_cold' |      // æå¯’ (<5Â°C)
  'very_cold' |         // å¾ˆå†· (5-10Â°C)
  'cold' |              // å†?(10-15Â°C)
  'warm' |              // æ¸©æš– (15-25Â°C)
  'hot' |               // çƒ?(25-30Â°C)
  'extreme_hot' |       // æçƒ­ (>30Â°C)
  'carnivore' |         // è‚‰é£Ÿæ€§é±¼ç±?
  'herbivore' |         // è‰é£Ÿæ€§é±¼ç±?
  'omnivore' |          // æ‚é£Ÿæ€§é±¼ç±?
  'filter_feeder' |     // æ»¤é£Ÿæ€§é±¼ç±?(é²¢é³™)
  'black_pit_new' |     // é»‘å‘æ–°æ”¾é±?
  'black_pit_old' |     // é»‘å‘è€é±¼/æ»‘å£é±?
  'black_pit_competition' | // é»‘å‘ç«æŠ€
  'wild_river_flow' |   // é‡æ²³æµæ°´
  'wild_river_still' |  // é‡æ²³é™æ°´
  'reservoir_shallow' | // æ°´åº“æµ…æ°´
  'reservoir_deep' |    // æ°´åº“æ·±æ°´
  'night_fishing' |     // å¤œé’“
  'dawn_fishing' |      // æ—©é’“ (å¤©äº®å‰å)
  'noon_fishing' |      // åˆé’“ (ä¸­åˆé«˜æ¸©)
  'rainy' |             // é›¨å¤©
  'after_rain' |        // é›¨å
  'windy' |             // å¤§é£å¤?
  'pressure_low' |      // ä½æ°”å?
  'pressure_high' |     // é«˜æ°”å?
  'muddy_water' |       // æµ‘æ°´
  'clear_water' |       // æ¸…æ°´
  'algae_bloom';        // æ°´å/è—»ç±»çˆ†å‘

// åœºæ™¯è§„åˆ™
export class ScenarioRule {
  scenarioType: ScenarioType = 'warm';
  name: string = '';
  description: string = '';
  flavorModifier: FlavorModifier = new FlavorModifier();
  stateModifier: StateModifier = new StateModifier();
  recommendedIngredients: string[] = [];
  avoidIngredients: string[] = [];
  tips: string[] = [];
  priority: number = 0;  // ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šé«˜è¶Šä¼˜å…ˆåº”ç”¨

  constructor() {}
}

// åˆ›å»ºåœºæ™¯è§„åˆ™çš„è¾…åŠ©å‡½æ•?
function createRule(
  type: ScenarioType,
  name: string,
  desc: string,
  flavorMod: FlavorModifier,
  stateMod: StateModifier,
  recommended: string[],
  avoid: string[],
  tips: string[],
  priority: number
): ScenarioRule {
  const rule = new ScenarioRule();
  rule.scenarioType = type;
  rule.name = name;
  rule.description = desc;
  rule.flavorModifier = flavorMod;
  rule.stateModifier = stateMod;
  rule.recommendedIngredients = recommended;
  rule.avoidIngredients = avoid;
  rule.tips = tips;
  rule.priority = priority;
  return rule;
}

// ==================== æ¸©åº¦ç›¸å…³åœºæ™¯ ====================
function getTemperatureScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // æå¯’åœºæ™¯ (<5Â°C)
  rules.push(createRule(
    'extreme_cold',
    'æå¯’å¤©æ°”',
    'æ°´æ¸©æä½ï¼Œé±¼æ´»æ€§æå·®ï¼Œéœ€è¦é«˜è…¥é«˜è›‹ç™½åˆºæ¿€',
    FlavorModifier.create(50, 20, 15, -20, 10),
    StateModifier.create(-30, 25, 20),
    ['bloodworm_powder', 'earthworm_powder', 'fish_meal', 'shrimp_powder', 'liver_powder'],
    ['citric_acid', 'lactic_acid', 'light_bran'],
    ['ä½¿ç”¨æ´»çº¢è™«æ•ˆæœæœ€ä½?, 'é¥µæ–™çŠ¶æ€è¦è½¯ç²˜', 'å°é¥µæ…¢é¢‘ç?, 'é€‰æ‹©å‘é˜³èƒŒé£é’“ä½'],
    100
  ));

  // å¾ˆå†·åœºæ™¯ (5-10Â°C)
  rules.push(createRule(
    'very_cold',
    'ä½æ¸©å¤©æ°”',
    'æ°´æ¸©è¾ƒä½ï¼Œé±¼å¼€å£æ…¢ï¼Œéœ€è¦æµ“è…¥æµ“é¦?,
    FlavorModifier.create(35, 15, 10, -10, 5),
    StateModifier.create(-20, 15, 15),
    ['bloodworm_powder', 'fish_meal', 'shrimp_powder', 'silkworm_pupa_powder'],
    ['citric_acid', 'snowflake_powder'],
    ['è…¥é¦™ä¸ºä¸»', 'é€‚å½“å¢åŠ å°è¯ç”¨é‡', 'è€å¿ƒç­‰å£'],
    90
  ));

  // å†·åœºæ™?(10-15Â°C)
  rules.push(createRule(
    'cold',
    'å‡‰çˆ½å¤©æ°”',
    'æ°´æ¸©åä½ï¼Œé€‚å½“å¢è…¥',
    FlavorModifier.create(20, 10, 5, 0, 0),
    StateModifier.create(-10, 10, 10),
    ['fish_meal', 'shrimp_powder', 'earthworm_powder'],
    [],
    ['è…¥é¦™æ­é…', 'çŠ¶æ€é€‚ä¸­'],
    80
  ));

  // æ¸©æš–åœºæ™¯ (15-25Â°C)
  rules.push(createRule(
    'warm',
    'é€‚å®œå¤©æ°”',
    'æ°´æ¸©é€‚å®œï¼Œé±¼æ´»æ€§å¥½ï¼Œå‘³å‹å‡è¡?,
    FlavorModifier.create(0, 0, 0, 0, 0),
    StateModifier.create(0, 0, 0),
    [],
    [],
    ['æ ¹æ®é±¼ç§è°ƒæ•´å‘³å‹', 'çŠ¶æ€æ ¹æ®é’“æ³•è°ƒæ•?],
    50
  ));

  // çƒ­åœºæ™?(25-30Â°C)
  rules.push(createRule(
    'hot',
    'é«˜æ¸©å¤©æ°”',
    'æ°´æ¸©è¾ƒé«˜ï¼Œé±¼é£Ÿæ¬²ä¸‹é™ï¼Œéœ€è¦æ¸…æ·¡é…æ–?,
    FlavorModifier.create(-25, 10, -15, 25, 0),
    StateModifier.create(15, -15, -10),
    ['citric_acid', 'lactic_acid', 'strawberry_essence', 'banana_essence'],
    ['fish_meal', 'blood_meal', 'liver_powder'],
    ['æ¸…æ·¡æœé…¸ä¸ºä¸»', 'æ—©æ™šå‡ºé’“æ•ˆæœå¥?, 'é€‰æ‹©é˜´å‡‰é’“ä½'],
    85
  ));

  // æçƒ­åœºæ™¯ (>30Â°C)
  rules.push(createRule(
    'extreme_hot',
    'é…·æš‘å¤©æ°”',
    'æ°´æ¸©æé«˜ï¼Œé±¼èº²é¿é«˜æ¸©ï¼Œéœ€è¦ææ¸…æ·¡é…æ–¹',
    FlavorModifier.create(-40, 5, -25, 35, 0),
    StateModifier.create(25, -25, -20),
    ['citric_acid', 'lactic_acid', 'acetic_acid', 'yogurt', 'cola'],
    ['fish_meal', 'blood_meal', 'shrimp_powder', 'earthworm_powder'],
    ['æœé…¸ä¸ºä¸»', 'å‡Œæ™¨æˆ–å‚æ™šå‡ºé’?, 'æ·±æ°´æˆ–é˜´å‡‰å¤„', 'å¯å°è¯•é’“æµ?],
    95
  ));

  return rules;
}


// ==================== é±¼ç±»é£Ÿæ€§åœºæ™?====================
function getFishTypeScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // è‚‰é£Ÿæ€§é±¼ç±?
  rules.push(createRule(
    'carnivore',
    'è‚‰é£Ÿæ€§é±¼ç±?,
    'é²¶é±¼ã€é»‘é±¼ã€é³œé±¼ç­‰è‚‰é£Ÿæ€§é±¼ç±»ï¼Œéœ€è¦æµ“è…¥é…æ–?,
    FlavorModifier.create(40, -10, -20, 0, 30),
    StateModifier.create(-15, 15, 15),
    ['fish_meal', 'blood_meal', 'liver_powder', 'earthworm_powder', 'shrimp_powder', 'squid_powder'],
    ['corn_flour', 'sweet_potato_flour', 'vanilla_essence', 'strawberry_essence'],
    ['æ´»é¥µæ•ˆæœæœ€ä½?, 'è…¥è‡­å‘³å‹ä¸ºä¸»', 'é¥µæ–™è¦æœ‰éŸ§æ€?, 'å¤œé’“æ•ˆæœå¥?],
    70
  ));

  // è‰é£Ÿæ€§é±¼ç±?
  rules.push(createRule(
    'herbivore',
    'è‰é£Ÿæ€§é±¼ç±?,
    'è‰é±¼ç­‰è‰é£Ÿæ€§é±¼ç±»ï¼Œéœ€è¦é¦™ç”œé…¸é…æ–¹',
    FlavorModifier.create(-20, 25, 20, 20, 0),
    StateModifier.create(10, -10, -5),
    ['corn_flour', 'wheat_bran', 'sweet_potato_flour', 'tender_grass', 'mulberry', 'citric_acid'],
    ['fish_meal', 'blood_meal', 'liver_powder'],
    ['å«©è‰ã€æ¡‘è‘šç­‰å¤©ç„¶é¥µæ•ˆæœå¥½', 'å‘é…µé¥µè¯±é±¼æ•ˆæœä½³', 'å¤å­£æœé…¸å‘³å‹'],
    70
  ));

  // æ‚é£Ÿæ€§é±¼ç±?
  rules.push(createRule(
    'omnivore',
    'æ‚é£Ÿæ€§é±¼ç±?,
    'é²«é±¼ã€é²¤é±¼ç­‰æ‚é£Ÿæ€§é±¼ç±»ï¼Œå‘³å‹å‡è¡¡',
    FlavorModifier.create(0, 0, 0, 0, 0),
    StateModifier.create(0, 0, 0),
    [],
    [],
    ['æ ¹æ®å­£èŠ‚è°ƒæ•´å‘³å‹', 'è…¥é¦™ç”œæ­é…?],
    50
  ));

  // æ»¤é£Ÿæ€§é±¼ç±?
  rules.push(createRule(
    'filter_feeder',
    'æ»¤é£Ÿæ€§é±¼ç±?,
    'é²¢é±¼ã€é³™é±¼ç­‰æ»¤é£Ÿæ€§é±¼ç±»ï¼Œéœ€è¦é…¸è‡­é›¾åŒ–é…æ–?,
    FlavorModifier.create(-10, 0, -20, 50, 60),
    StateModifier.create(40, -30, -25),
    ['wheat_bran', 'rice_bran', 'citric_acid', 'lactic_acid', 'acetic_acid', 'stinky_tofu_juice', 'garlic_essence'],
    ['drawing_powder', 'sticky_powder', 'heavy_powder'],
    ['é…¸è‡­å‘³å‹ä¸ºä¸»', 'æå¿«é›¾åŒ–', 'é’“æµ®æˆ–é’“åŠæ°´', 'å¤§é¥µå›¢æŠ½çª?],
    75
  ));

  return rules;
}

// ==================== é»‘å‘åœºæ™¯ ====================
function getBlackPitScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // é»‘å‘æ–°æ”¾é±?
  rules.push(createRule(
    'black_pit_new',
    'é»‘å‘æ–°æ”¾é±?,
    'åˆšæ”¾çš„ç”Ÿå£é±¼ï¼ŒæŠ¢é±¼ä¸ºä¸?,
    FlavorModifier.create(15, 20, 10, 0, 0),
    StateModifier.create(25, -15, -10),
    ['dmpt', 'betaine', 'amino_acid', 'fishy_essence', 'honey_essence'],
    [],
    ['å¿«é›¾åŒ–æŠ¢é±?, 'å¯é€‚å½“åŠ å°è?, 'é¢‘ç‡è¦å¿«', 'æŠ¢å å¥½é’“ä½?],
    85
  ));

  // é»‘å‘è€é±¼/æ»‘å£é±?
  rules.push(createRule(
    'black_pit_old',
    'é»‘å‘è€é±¼',
    'è¢«é’“è¿‡å¤šæ¬¡çš„æ»‘å£é±¼ï¼Œéœ€è¦æœ¬å‘³é…æ–?,
    FlavorModifier.create(-20, -15, -10, 0, 0),
    StateModifier.create(-20, 15, 10),
    ['corn_flour', 'wheat_bran', 'soybean_flour', 'pellet_powder'],
    ['dmpt', 'fishy_essence', 'vanilla_essence'],
    ['æœ¬å‘³ä¸ºä¸»', 'å‡å°‘å°è¯', 'æ…¢é›¾åŒ?, 'ç»†çº¿å°é’©', 'è€å¿ƒå®ˆé’“'],
    85
  ));

  // é»‘å‘ç«æŠ€
  rules.push(createRule(
    'black_pit_competition',
    'é»‘å‘ç«æŠ€',
    'ç«æŠ€æ¯”èµ›ï¼Œéœ€è¦å¿«é€Ÿè¯±é±?,
    FlavorModifier.create(20, 25, 15, 0, 0),
    StateModifier.create(30, -20, -15),
    ['dmpt', 'betaine', 'amino_acid', 'snowflake_powder', 'light_bran'],
    ['sticky_powder', 'heavy_powder'],
    ['æå¿«é›¾åŒ–', 'é«˜é¢‘ç‡æŠ½çª?, 'å°è¯é€‚é‡', 'æ³¨æ„æ¯”èµ›è§„åˆ™'],
    90
  ));

  return rules;
}

// ==================== é‡é’“åœºæ™¯ ====================
function getWildFishingScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // é‡æ²³æµæ°´
  rules.push(createRule(
    'wild_river_flow',
    'é‡æ²³æµæ°´',
    'æœ‰æ°´æµçš„é‡æ²³ï¼Œéœ€è¦å¢åŠ ç²˜åº¦å’Œæ¯”é‡',
    FlavorModifier.create(5, 5, 0, 0, 0),
    StateModifier.create(-25, 30, 25),
    ['sticky_powder', 'heavy_powder', 'glutinous_rice_flour', 'drawing_powder'],
    ['snowflake_powder', 'light_bran', 'puffed_corn'],
    ['å¢åŠ ç²˜åº¦é˜²å†²æ•?, 'é‡æ¯”é‡å¿«åˆ°åº•', 'é€‰æ‹©å›æ°´æ¹?, 'èµ°æ¼‚é’“æ³•'],
    80
  ));

  // é‡æ²³é™æ°´
  rules.push(createRule(
    'wild_river_still',
    'é‡æ²³é™æ°´',
    'é™æ°´åŒºåŸŸçš„é‡æ²³ï¼ŒçŠ¶æ€é€‚ä¸­',
    FlavorModifier.create(0, 0, 0, 0, 0),
    StateModifier.create(0, 5, 5),
    [],
    [],
    ['çŠ¶æ€é€‚ä¸­', 'é…’ç±³æ‰“çªæ•ˆæœå¥?, 'é€‰æ‹©æ°´è‰è¾?],
    60
  ));

  // æ°´åº“æµ…æ°´
  rules.push(createRule(
    'reservoir_shallow',
    'æ°´åº“æµ…æ°´',
    'æ°´åº“æµ…æ°´åŒºï¼Œé€‚åˆé’“å°å‹é±¼',
    FlavorModifier.create(5, 10, 5, 0, 0),
    StateModifier.create(10, -5, -5),
    ['snowflake_powder', 'light_bran'],
    ['heavy_powder'],
    ['é›¾åŒ–é€‚ä¸­', 'å°é¥µä¸ºä¸»', 'æ³¨æ„æƒŠé±¼'],
    65
  ));

  // æ°´åº“æ·±æ°´
  rules.push(createRule(
    'reservoir_deep',
    'æ°´åº“æ·±æ°´',
    'æ°´åº“æ·±æ°´åŒºï¼Œé€‚åˆå®ˆé’“å¤§é±¼',
    FlavorModifier.create(10, 15, 10, 0, 5),
    StateModifier.create(-20, 20, 25),
    ['heavy_powder', 'sticky_powder', 'corn_kernel', 'wheat_kernel'],
    ['snowflake_powder', 'light_bran'],
    ['é‡æ¯”é‡å¿«åˆ°åº•', 'å¤§é¥µå®ˆé’“', 'æ‰“é‡çª?, 'è€å¿ƒç­‰å¾…'],
    75
  ));

  return rules;
}

// ==================== æ—¶æ®µåœºæ™¯ ====================
function getTimePeriodScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // å¤œé’“
  rules.push(createRule(
    'night_fishing',
    'å¤œé’“',
    'å¤œé—´é’“é±¼ï¼Œé±¼é å—…è§‰è§…é£?,
    FlavorModifier.create(15, 20, 10, 0, 10),
    StateModifier.create(-10, 10, 5),
    ['fishy_essence', 'garlic_essence', 'dmpt', 'earthworm', 'bloodworm'],
    [],
    ['å‘³å‹è¦æµ“', 'æ´»é¥µæ•ˆæœå¥?, 'æ³¨æ„å®‰å…¨', 'å¸¦å¥½ç…§æ˜'],
    70
  ));

  // æ—©é’“
  rules.push(createRule(
    'dawn_fishing',
    'æ—©é’“',
    'å¤©äº®å‰åï¼Œé±¼æ´»æ€§å¼€å§‹å¢åŠ?,
    FlavorModifier.create(10, 10, 5, 0, 0),
    StateModifier.create(5, 0, 0),
    [],
    [],
    ['é»„é‡‘æ—¶æ®µ', 'é±¼å¼€å£ç§¯æ?, 'æŠ“ç´§æ—¶é—´'],
    65
  ));

  // åˆé’“
  rules.push(createRule(
    'noon_fishing',
    'åˆé’“',
    'ä¸­åˆé«˜æ¸©æ—¶æ®µï¼Œé±¼æ´»æ€§ä¸‹é™?,
    FlavorModifier.create(-15, 5, -10, 15, 0),
    StateModifier.create(10, -10, -5),
    ['citric_acid', 'lactic_acid'],
    ['fish_meal', 'blood_meal'],
    ['æ¸…æ·¡ä¸ºä¸»', 'é€‰æ‹©é˜´å‡‰å¤?, 'å¯å°è¯•é’“æµ?, 'è€å¿ƒç­‰å¾…'],
    70
  ));

  return rules;
}

// ==================== å¤©æ°”åœºæ™¯ ====================
function getWeatherScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // é›¨å¤©
  rules.push(createRule(
    'rainy',
    'é›¨å¤©',
    'ä¸‹é›¨å¤©æ°”ï¼Œæ°´ä¸­æº¶æ°§å¢åŠ?,
    FlavorModifier.create(5, 5, 0, 5, 0),
    StateModifier.create(5, 0, 0),
    [],
    [],
    ['å°é›¨å¤©é±¼å¼€å£å¥½', 'æ³¨æ„é˜²æ»‘', 'é€‰æ‹©é¿é›¨é’“ä½'],
    60
  ));

  // é›¨å
  rules.push(createRule(
    'after_rain',
    'é›¨å',
    'é›¨åæ°´ä½ä¸Šæ¶¨ï¼Œé±¼é è¾¹è§…é£Ÿ',
    FlavorModifier.create(10, 10, 5, 0, 0),
    StateModifier.create(5, 5, 0),
    ['earthworm', 'earthworm_powder'],
    [],
    ['é›¨åé»„é‡‘æ—¶æ®µ', 'é’“è¿‘é’“è¾¹', 'èš¯èš“æ•ˆæœæä½³'],
    75
  ));

  // å¤§é£å¤?
  rules.push(createRule(
    'windy',
    'å¤§é£å¤?,
    'é£å¤§æµªå¤§ï¼Œéœ€è¦å¢åŠ æ¯”é‡?,
    FlavorModifier.create(5, 5, 0, 0, 0),
    StateModifier.create(-15, 15, 20),
    ['heavy_powder', 'sticky_powder'],
    ['snowflake_powder', 'light_bran'],
    ['å¢åŠ æ¯”é‡', 'é€‰æ‹©èƒŒé£å¤?, 'æ³¨æ„å®‰å…¨'],
    70
  ));

  // ä½æ°”å?
  rules.push(createRule(
    'pressure_low',
    'ä½æ°”å?,
    'æ°”å‹ä½ï¼Œæ°´ä¸­æº¶æ°§ä¸è¶³ï¼Œé±¼å¼€å£å·®',
    FlavorModifier.create(-10, -5, -5, 10, 0),
    StateModifier.create(10, -10, -10),
    ['citric_acid', 'lactic_acid'],
    ['fish_meal', 'blood_meal'],
    ['é±¼å¼€å£å·®', 'æ¸…æ·¡ä¸ºä¸»', 'å¯å°è¯•é’“æµ?, 'è€å¿ƒç­‰å¾…'],
    80
  ));

  // é«˜æ°”å?
  rules.push(createRule(
    'pressure_high',
    'é«˜æ°”å?,
    'æ°”å‹é«˜ï¼Œæ°´ä¸­æº¶æ°§å……è¶³ï¼Œé±¼æ´»æ€§å¥½',
    FlavorModifier.create(5, 5, 5, 0, 0),
    StateModifier.create(5, 0, 0),
    [],
    [],
    ['é±¼å¼€å£å¥½', 'æ­£å¸¸é…æ–¹å³å¯'],
    55
  ));

  return rules;
}

// ==================== æ°´è´¨åœºæ™¯ ====================
function getWaterQualityScenarios(): ScenarioRule[] {
  const rules: ScenarioRule[] = [];

  // æµ‘æ°´
  rules.push(createRule(
    'muddy_water',
    'æµ‘æ°´',
    'æ°´è´¨æµ‘æµŠï¼Œé±¼é å—…è§‰è§…é£?,
    FlavorModifier.create(20, 15, 10, 0, 10),
    StateModifier.create(-10, 10, 10),
    ['fishy_essence', 'garlic_essence', 'dmpt', 'fish_meal', 'shrimp_powder'],
    [],
    ['å‘³å‹è¦æµ“', 'é¢œè‰²é²œè‰³çš„é¥µæ–?, 'å¢åŠ è¯±é£Ÿå‰?],
    75
  ));

  // æ¸…æ°´
  rules.push(createRule(
    'clear_water',
    'æ¸…æ°´',
    'æ°´è´¨æ¸…æ¾ˆï¼Œé±¼è­¦æƒ•æ€§é«˜',
    FlavorModifier.create(-10, -5, -5, 0, 0),
    StateModifier.create(-5, 5, 5),
    [],
    ['dmpt', 'fishy_essence'],
    ['å‘³å‹è¦æ·¡', 'ç»†çº¿å°é’©', 'æ³¨æ„éšè”½', 'è‡ªç„¶é¥µæ•ˆæœå¥½'],
    70
  ));

  // æ°´å/è—»ç±»çˆ†å‘
  rules.push(createRule(
    'algae_bloom',
    'æ°´å',
    'è—»ç±»çˆ†å‘ï¼Œæ°´ä¸­æº¶æ°§ä¸ç¨³å®š',
    FlavorModifier.create(-15, 0, -10, 15, 0),
    StateModifier.create(15, -15, -10),
    ['citric_acid', 'lactic_acid'],
    ['fish_meal', 'blood_meal'],
    ['é±¼å¯èƒ½ç¼ºæ°?, 'æ¸…æ·¡æœé…¸', 'é€‰æ‹©è¿›æ°´å?, 'æ—©æ™šå‡ºé’“'],
    80
  ));

  return rules;
}


// ==================== åœºæ™¯è§„åˆ™æ•°æ®åº?====================
class ScenarioRulesDatabase {
  private static instance: ScenarioRulesDatabase | null = null;
  private rules: ScenarioRule[] = [];
  private ruleMap: Map<ScenarioType, ScenarioRule> = new Map();
  private initialized: boolean = false;

  private constructor() {}

  static getInstance(): ScenarioRulesDatabase {
    if (ScenarioRulesDatabase.instance === null) {
      ScenarioRulesDatabase.instance = new ScenarioRulesDatabase();
    }
    return ScenarioRulesDatabase.instance;
  }

  initialize(): void {
    if (this.initialized) return;

    // åŠ è½½æ‰€æœ‰åœºæ™¯è§„åˆ?
    const tempRules = getTemperatureScenarios();
    const fishRules = getFishTypeScenarios();
    const pitRules = getBlackPitScenarios();
    const wildRules = getWildFishingScenarios();
    const timeRules = getTimePeriodScenarios();
    const weatherRules = getWeatherScenarios();
    const waterRules = getWaterQualityScenarios();

    for (let i = 0; i < tempRules.length; i++) {
      this.rules.push(tempRules[i]);
      this.ruleMap.set(tempRules[i].scenarioType, tempRules[i]);
    }
    for (let i = 0; i < fishRules.length; i++) {
      this.rules.push(fishRules[i]);
      this.ruleMap.set(fishRules[i].scenarioType, fishRules[i]);
    }
    for (let i = 0; i < pitRules.length; i++) {
      this.rules.push(pitRules[i]);
      this.ruleMap.set(pitRules[i].scenarioType, pitRules[i]);
    }
    for (let i = 0; i < wildRules.length; i++) {
      this.rules.push(wildRules[i]);
      this.ruleMap.set(wildRules[i].scenarioType, wildRules[i]);
    }
    for (let i = 0; i < timeRules.length; i++) {
      this.rules.push(timeRules[i]);
      this.ruleMap.set(timeRules[i].scenarioType, timeRules[i]);
    }
    for (let i = 0; i < weatherRules.length; i++) {
      this.rules.push(weatherRules[i]);
      this.ruleMap.set(weatherRules[i].scenarioType, weatherRules[i]);
    }
    for (let i = 0; i < waterRules.length; i++) {
      this.rules.push(waterRules[i]);
      this.ruleMap.set(waterRules[i].scenarioType, waterRules[i]);
    }

    this.initialized = true;
  }

  getRule(scenarioType: ScenarioType): ScenarioRule | null {
    this.initialize();
    return this.ruleMap.get(scenarioType) || null;
  }

  getAllRules(): ScenarioRule[] {
    this.initialize();
    return this.rules;
  }

  getRulesByPriority(minPriority: number = 0): ScenarioRule[] {
    this.initialize();
    const result: ScenarioRule[] = [];
    for (let i = 0; i < this.rules.length; i++) {
      if (this.rules[i].priority >= minPriority) {
        result.push(this.rules[i]);
      }
    }
    // æŒ‰ä¼˜å…ˆçº§æ’åº
    result.sort((a, b) => b.priority - a.priority);
    return result;
  }

  getTemperatureScenario(temp: number): ScenarioType {
    if (temp < 5) return 'extreme_cold';
    if (temp < 10) return 'very_cold';
    if (temp < 15) return 'cold';
    if (temp < 25) return 'warm';
    if (temp < 30) return 'hot';
    return 'extreme_hot';
  }

  getRuleCount(): number {
    this.initialize();
    return this.rules.length;
  }
}

// å¯¼å‡ºå•ä¾‹
export const scenarioRulesDatabase = ScenarioRulesDatabase.getInstance();

// å¯¼å‡ºä¾¿æ·å‡½æ•°
export function getScenarioRule(scenarioType: ScenarioType): ScenarioRule | null {
  return scenarioRulesDatabase.getRule(scenarioType);
}

export function getAllScenarioRules(): ScenarioRule[] {
  return scenarioRulesDatabase.getAllRules();
}

export function getTemperatureScenario(temp: number): ScenarioType {
  return scenarioRulesDatabase.getTemperatureScenario(temp);
}

export function getScenarioRulesByPriority(minPriority: number = 0): ScenarioRule[] {
  return scenarioRulesDatabase.getRulesByPriority(minPriority);
}

/**
 * é¥µçŸ¥é?- è·¯ç”±ç®¡ç†
 */
import { router } from '@kit.ArkUI';
import { AppConstants } from '../common/constants/AppConstants';

// è·¯ç”±å‚æ•°ç±?
export class RouteParams {
  recipeId?: string;
  recordId?: string;
  fish?: string;
  water?: string;
  season?: string;
  id?: string;
  isEdit?: boolean;
  // åè®®é¡µé¢å‚æ•°
  title?: string;
  type?: string;
}

export class Router {
  /**
   * è·³è½¬é¡µé¢
   */
  static async push(url: string, params?: RouteParams): Promise<void> {
    try {
      const options: router.RouterOptions = { url: url };
      if (params) {
        options.params = params;
      }
      await router.pushUrl(options, router.RouterMode.Standard);
    } catch (error) {
      console.error(`[Router] push failed: ${(error as Error).message}`);
    }
  }

  /**
   * æ›¿æ¢é¡µé¢
   */
  static async replace(url: string, params?: RouteParams): Promise<void> {
    try {
      const options: router.RouterOptions = { url: url };
      if (params) {
        options.params = params;
      }
      await router.replaceUrl(options, router.RouterMode.Standard);
    } catch (error) {
      console.error(`[Router] replace failed: ${(error as Error).message}`);
    }
  }

  /**
   * è¿”å›ä¸Šä¸€é¡?
   */
  static back(): void {
    router.back();
  }

  /**
   * è·å–è·¯ç”±å‚æ•°
   */
  static getParams(): RouteParams {
    const params = router.getParams();
    return (params as RouteParams) || {};
  }

  // é¢„å®šä¹‰è·¯ç”±æ–¹æ³?
  static async goToMain(): Promise<void> {
    await Router.replace(AppConstants.ROUTE_MAIN);
  }

  static async goToRecipeDetail(recipeId: string): Promise<void> {
    const params = new RouteParams();
    params.recipeId = recipeId;
    await Router.push(AppConstants.ROUTE_RECIPE_DETAIL, params);
  }

  static async goToGeneratedRecipe(params: RouteParams): Promise<void> {
    await Router.push(AppConstants.ROUTE_GENERATED_RECIPE, params);
  }

  static async goToAddRecord(): Promise<void> {
    await Router.push(AppConstants.ROUTE_ADD_RECORD);
  }

  static async goToFavorite(): Promise<void> {
    await Router.push(AppConstants.ROUTE_FAVORITE);
  }

  static async goToSettings(): Promise<void> {
    await Router.push(AppConstants.ROUTE_SETTINGS);
  }

  static async goToRecordDetail(recordId: string, isEdit: boolean = false): Promise<void> {
    const params = new RouteParams();
    params.recordId = recordId;
    params.isEdit = isEdit;
    await Router.push(AppConstants.ROUTE_RECORD_DETAIL, params);
  }

  static async goToGeneratorHistory(): Promise<void> {
    await Router.push(AppConstants.ROUTE_GENERATOR_HISTORY);
  }

  static async goToMap(): Promise<void> {
    await Router.push(AppConstants.ROUTE_MAP);
  }
}

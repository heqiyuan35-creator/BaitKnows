<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="echarts.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: transparent; }
    #chart { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="chart"></div>
  <script>
    const chart = echarts.init(document.getElementById('chart'));
    
    // 默认配置
    const defaultOption = {
      grid: {
        left: '3%',
        right: '10%',
        top: '5%',
        bottom: '5%',
        containLabel: true
      },
      xAxis: {
        type: 'value',
        max: 30,
        axisLine: { show: false },
        axisTick: { show: false },
        axisLabel: {
          color: '#999',
          fontSize: 10
        },
        splitLine: {
          lineStyle: { color: '#F0F0F0' }
        }
      },
      yAxis: {
        type: 'category',
        data: ['目标鱼种', '季节温度', '水域环境', '水深', '水质', '光照条件', '风力', '味型偏好'],
        axisLine: { show: false },
        axisTick: { show: false },
        axisLabel: {
          color: '#666',
          fontSize: 11
        }
      },
      series: [{
        type: 'bar',
        data: [25, 20, 15, 10, 10, 8, 5, 7],
        barWidth: 12,
        itemStyle: {
          color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
            { offset: 0, color: '#E6A23C' },
            { offset: 1, color: '#F5C77E' }
          ]),
          borderRadius: [0, 6, 6, 0]
        },
        label: {
          show: true,
          position: 'right',
          formatter: '{c}%',
          color: '#E6A23C',
          fontSize: 11
        }
      }]
    };
    
    chart.setOption(defaultOption);
    
    // 更新数据的函数，供ArkTS调用
    function updateData(weights) {
      try {
        const data = typeof weights === 'string' ? JSON.parse(weights) : weights;
        const names = data.map(item => item.name);
        const values = data.map(item => item.weight);
        
        chart.setOption({
          yAxis: {
            data: names.reverse()
          },
          series: [{
            data: values.reverse()
          }]
        });
      } catch (e) {
        console.error('Update bar data error:', e);
      }
    }
    
    // 窗口大小变化时重绘
    window.addEventListener('resize', function() {
      chart.resize();
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="echarts.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: transparent; }
    #chart { width: 100%; height: 100%; }
  </style>
</head>
<body>
  <div id="chart"></div>
  <script>
    const chart = echarts.init(document.getElementById('chart'));
    
    // 默认配置
    const defaultOption = {
      tooltip: {
        trigger: 'item',
        formatter: '{b}: {d}%'
      },
      legend: {
        orient: 'vertical',
        right: 10,
        top: 'center',
        textStyle: {
          fontSize: 12,
          color: '#666'
        }
      },
      series: [{
        type: 'pie',
        radius: ['40%', '70%'],
        center: ['35%', '50%'],
        avoidLabelOverlap: false,
        label: {
          show: false
        },
        emphasis: {
          label: {
            show: true,
            fontSize: 14,
            fontWeight: 'bold'
          }
        },
        labelLine: {
          show: false
        },
        data: [
          { value: 40, name: '基础饵', itemStyle: { color: '#E6A23C' } },
          { value: 25, name: '主攻饵', itemStyle: { color: '#67C23A' } },
          { value: 20, name: '状态饵', itemStyle: { color: '#409EFF' } },
          { value: 15, name: '添加剂', itemStyle: { color: '#F56C6C' } }
        ]
      }]
    };
    
    chart.setOption(defaultOption);
    
    // 更新数据的函数，供ArkTS调用
    function updateData(ratios) {
      try {
        const data = typeof ratios === 'string' ? JSON.parse(ratios) : ratios;
        const pieData = data.map(item => ({
          value: item.percentage,
          name: item.category || item.name,
          itemStyle: { color: item.color || '#E6A23C' }
        }));
        
        chart.setOption({
          series: [{
            data: pieData
          }]
        });
      } catch (e) {
        console.error('Update pie data error:', e);
      }
    }
    
    // 窗口大小变化时重绘
    window.addEventListener('resize', function() {
      chart.resize();
    });
  </script>
</body>
</html>
